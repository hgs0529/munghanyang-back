<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="mul.com.sns.dao.FeedDao">
<select id="getallFeed" resultType="mul.com.sns.dto.FeedDto">
	SELECT * 
	FROM PHOTO
	ORDER BY CREATED_AT DESC
</select>

<insert id="addFeed" parameterType="mul.com.sns.dto.FeedDto">
	INSERT INTO PHOTO(USERID, FILE, CONTENT, CREATED_AT, UPDATE_AT)
	VALUES(#{userid}, #{file},#{content},NOW(),NULL)
</insert>

<update id="updateFeed" parameterType="mul.com.sns.dto.FeedDto">
	UPDATE PHOTO
	SET CONTENT=#{content},
		UPDATE_AT=NOW()
	WHERE SEQ=#{seq}
</update>

<delete id="deleteFeed" parameterType="Integer">
	DELETE 
	FROM PHOTO
	WHERE SEQ=#{seq}
</delete>

<!-- **********************좋아요***************************** -->
<!-- like 누르기 (좋아요) -->
<insert id="givelikes" parameterType="mul.com.sns.dto.LikesDto">
	INSERT INTO LIKES(USERID, PHOTOID)
	VALUES(#{userid}, #{photoid})		  
</insert>

<!-- like 취소하기 -->
<delete id="deletelikes" parameterType="mul.com.sns.dto.LikesDto">
	DELETE FROM LIKES
	WHERE USERID=#{userid} AND PHOTOID=#{photoid}
</delete>

<!-- 좋아요 수 -->
<select id="countlikes" parameterType="mul.com.sns.dto.LikesDto" resultType="mul.com.sns.dto.LikesDto">
	SELECT COUNT(SEQ)
	FROM LIKES
	WHERE USERID=#{userid} AND PHOTOID=#{photoid}
</select>
 
<!-- 내가 좋아요한 모든 글 -->
<select id="likelist" resultType="mul.com.sns.dto.LikesDto">
	SELECT PHOTOID
	FROM LIKES
	WHERE USERID = #{userid}
</select>

</mapper>